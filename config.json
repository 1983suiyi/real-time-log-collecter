{
  "behaviors": [
    {
      "name": "会话开启",
      "description": "检测应用会话开始",
      "level": "info",
      "pattern": ".*session_start.*",
      "dataType": "text",
      "enabled": true,
      "priority": 5
    },
    {
      "name": "会话结束",
      "description": "检测应用会话结束",
      "level": "info",
      "pattern": ".*session_end.*",
      "dataType": "text",
      "enabled": true,
      "priority": 5
    },
    {
      "name": "用户行为数据",
      "description": "检测用户行为JSON数据",
      "level": "info",
      "pattern": ".*user_behavior.*",
      "dataType": "json",
      "validation": {
        "required": true,
        "jsonSchema": {
          "type": "object",
          "properties": {
            "userId": {"type": "string"},
            "action": {"type": "string"},
            "timestamp": {"type": "number"},
            "data": {"type": "object"}
          },
          "required": ["userId", "action", "timestamp"]
        }
      },
      "extractors": [
        {
          "name": "userBehaviorData",
          "pattern": "user_behavior:\\s*({.*})",
          "dataType": "json"
        }
      ],
      "enabled": true,
      "priority": 8
    },
    {
      "name": "性能指标",
      "description": "检测性能相关的数值数据",
      "level": "warn",
      "pattern": ".*performance.*fps:\\s*(\\d+)",
      "dataType": "number",
      "validation": {
        "numberRange": {
          "min": 0,
          "max": 120
        }
      },
      "extractors": [
        {
          "name": "fpsValue",
          "pattern": "fps:\\s*(\\d+)",
          "dataType": "number"
        }
      ],
      "enabled": true,
      "priority": 7
    },
    {
      "name": "错误状态",
      "description": "检测错误状态的布尔值",
      "level": "error",
      "pattern": ".*error_state:\\s*(true|false)",
      "dataType": "boolean",
      "extractors": [
        {
          "name": "errorState",
          "pattern": "error_state:\\s*(true|false)",
          "dataType": "boolean"
        }
      ],
      "enabled": true,
      "priority": 9
    },
    {
      "name": "RUM数据上报",
      "description": "检测RUM元素刷新成功的JSON数据",
      "level": "info",
      "pattern": ".*RUM element flushed success:.*",
      "dataType": "json",
      "validation": {
        "required": true,
        "jsonSchema": {
          "type": "object",
          "properties": {
            "app_id": {"type": "string"},
            "data_version": {"type": "string"},
            "event": {"type": "string"},
            "rum_id": {"type": "string"},
            "ts": {"type": "string"},
            "properties": {
              "type": "object",
              "properties": {
                "app_version": {"type": "string"},
                "app_build_code": {"type": "number"},
                "sdk_version": {"type": "string"},
                "device": {"type": "string"},
                "os": {"type": "string"},
                "os_version": {"type": "string"},
                "android_id": {"type": "string"},
                "http_status": {"type": "string"},
                "sha-1": {"type": "string"},
                "android_gps_version": {"type": "string"},
                "call_stack_symbols": {"type": "string"},
                "module": {"type": "string"},
                "log_type": {"type": "string"},
                "log_level": {"type": "string"},
                "service_name": {"type": "string"},
                "config_etag": {"type": "string"},
                "target_user_id": {"type": "string"},
                "log": {"type": "string"}
              },
              "required": ["app_version", "sdk_version", "device", "os"]
            }
          },
          "required": ["app_id", "data_version", "event", "rum_id", "ts", "properties"]
        }
      },
      "extractors": [
        {
          "name": "rumData",
          "pattern": "RUM element flushed success:\\s*({.*})",
          "dataType": "json"
        }
      ],
      "enabled": true,
      "priority": 6
    }
  ],
  "globalSettings": {
    "maxLogHistory": 1000,
    "enableRealTimeValidation": true,
    "validationTimeout": 5000
  }
}